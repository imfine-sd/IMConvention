(function(e){function n(n){for(var o,r,s=n[0],c=n[1],l=n[2],d=0,f=[];d<s.length;d++)r=s[d],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&f.push(i[r][0]),i[r]=0;for(o in c)Object.prototype.hasOwnProperty.call(c,o)&&(e[o]=c[o]);u&&u(n);while(f.length)f.shift()();return a.push.apply(a,l||[]),t()}function t(){for(var e,n=0;n<a.length;n++){for(var t=a[n],o=!0,s=1;s<t.length;s++){var c=t[s];0!==i[c]&&(o=!1)}o&&(a.splice(n--,1),e=r(r.s=t[0]))}return e}var o={},i={app:0},a=[];function r(n){if(o[n])return o[n].exports;var t=o[n]={i:n,l:!1,exports:{}};return e[n].call(t.exports,t,t.exports,r),t.l=!0,t.exports}r.m=e,r.c=o,r.d=function(e,n,t){r.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:t})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,n){if(1&n&&(e=r(e)),8&n)return e;if(4&n&&"object"===typeof e&&e&&e.__esModule)return e;var t=Object.create(null);if(r.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:e}),2&n&&"string"!=typeof e)for(var o in e)r.d(t,o,function(n){return e[n]}.bind(null,o));return t},r.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return r.d(n,"a",n),n},r.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},r.p="/IMConvention/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=n,s=s.slice();for(var l=0;l<s.length;l++)n(s[l]);var u=c;a.push([0,"chunk-vendors"]),t()})({0:function(e,n,t){e.exports=t("56d7")},"03f0":function(e,n,t){"use strict";t("246e")},"246e":function(e,n,t){},"56d7":function(e,n,t){"use strict";t.r(n);t("e260"),t("e6cf"),t("cca6"),t("a79d");var o=t("2b0e"),i=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("router-view")],1)},a=[],r=t("5530"),s=t("260b"),c=(t("66ce"),{apiKey:"AIzaSyBtnFzSNMp30pWM2CNva-U9ZM1sdE8lzts",authDomain:"fir-ca8ad.firebaseapp.com",databaseURL:"https://fir-ca8ad.firebaseio.com",projectId:"fir-ca8ad",storageBucket:"fir-ca8ad.appspot.com",messagingSenderId:"371247898053",appId:"1:371247898053:web:6c4786de640f7d0f47bfac",measurementId:"G-1CF0K55L16"});function l(){return s["a"].database().ref("/messages").orderByChild("time").once("value")}function u(e){return s["a"].database().ref("/messages").orderByChild("time").limitToLast(e).once("value")}function d(e){return s["a"].database().ref("/messages").orderByChild("time").startAt(e+1).once("value")}function f(e,n){var t=s["a"].database().ref("/"+e).child("data").push().key,o="/"+t,i={};return i[e+"/"+o]=Object(r["a"])({},n),s["a"].database().ref().update(i,(function(e){return e}))}s["a"].initializeApp(c);var v={name:"App",components:{},created:function(){l()},data:function(){return{}}},m=v,p=t("2877"),g=Object(p["a"])(m,i,a,!1,null,null,null),h=g.exports,b=t("9483");Object(b["a"])("".concat("/IMConvention/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});var E=t("8c4f"),_=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[e._v(" INFO "),t("form",[t("v-text-field",{attrs:{counter:10,label:"Name",required:""}}),t("v-text-field",{attrs:{label:"E-mail",required:""}}),t("v-btn",{staticClass:"mr-4",on:{click:e.submit}},[e._v(" submit ")]),t("v-btn",{on:{click:e.clear}},[e._v(" clear ")])],1),t("button",{on:{click:e.gotoPreset}},[e._v("TO PRESET")])])},S=[],T=(t("b0c0"),{methods:{gotoPreset:function(){this.$router.push("/event/preset")},submit:function(){this.$v.$touch()},clear:function(){this.$v.$reset(),this.name="",this.email="",this.select=null,this.checkbox=!1}}}),C=T,R=t("6544"),w=t.n(R),B=t("8336"),P=t("8654"),O=Object(p["a"])(C,_,S,!1,null,null,null),I=O.exports;w()(O,{VBtn:B["a"],VTextField:P["a"]});var A,M,y,W,D,x=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[t("div",{staticClass:"root"},[e._v(" Event "+e._s(e.test_message)+" "),t("button",{on:{click:e.goBack}},[e._v("Go Back")]),t("button",{on:{click:e.gotoHome}},[e._v("To Home")]),t("router-view",{staticClass:"contents"})],1),t("div",{class:e.sender_bg_class},[t("WebRTCSender",{class:e.sender_class,attrs:{width:"500",height:"500"}})],1)])},k=[],N=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("video",{attrs:{id:"wowza-sender",autoplay:"",playsinline:"",muted:"",controls:""},domProps:{muted:!0}})},j=[],U=(t("ac1f"),t("5319"),t("1276"),t("d81d"),t("b680"),t("d3b7"),t("3ca3"),t("498a"),t("ddb0"),t("2b3d"),t("53ca")),L=(t("96cf"),t("1da1")),V=(t("caad"),t("c975"),t("fb6a"),t("a9e3"),t("4d63"),t("25f0"),t("2532"),t("466d"),t("2ca0"),t("d093")),z=V["a"].browserDetails;function F(e,n){var t=e.split(/\r\n/),o="",i=!1;for(var a in t){var r=t[a];r.length<=0||(o+=r,o+="\r\n",0=="a=rtcp-mux".localeCompare(r)&&0==i&&(o+=n,i=!0))}return o}function $(e,n){var t=e.split(/\r\n/),o="",i=!1,a=!1,r=!1;for(var s in t){var c=t[s];c.length<=0||(c.includes("a=rtcp-rsize")&&(a=!0),c.includes("a=rtcp-mux")&&(r=!0,console.log(r)))}for(var l in t){var u=t[l];o+=u,o+="\r\n",0=="a=rtcp-rsize".localeCompare(u)&&0==i&&1==a&&(o+=n,i=!0),0=="a=rtcp-mux".localeCompare(u)&&1==i&&0==a&&(o+=n,i=!0),0=="a=rtcp-mux".localeCompare(u)&&0==i&&0==a&&(i=!0)}return o}function G(e,n){for(var t in A){var o=A[t];if(o.includes(e)){if(e.includes("VP9")||e.includes("VP8")){var i="",a=o.split(/\r\n/);for(var r in a){var s=a[r];i+=s,i+="\r\n"}return n.includes("audio")&&(D=t),n.includes("video")&&(W=t),i}return n.includes("audio")&&(D=t),n.includes("video")&&(W=t),o}}return""}function J(e){if(e.startsWith("a=rtpmap")||e.startsWith("a=rtcp-fb")||e.startsWith("a=fmtp")){var n=e.split(":");if(n.length>1){var t=n[1].split(" ");if(!isNaN(t[0])&&!t[1].startsWith("http")&&!t[1].startsWith("ur")){var o=A[t[0]];return o||(o=""),o+=e+"\r\n",A[t[0]]=o,!1}}}return!0}function H(e){var n=new RegExp("a=rtpmap:(\\d+) (\\w+)/(\\d+)"),t=e.match(n);return t&&t.length>=3?t:null}function Z(e,n){A=new Object,M="42e01f",y="opus",W=-1,D=-1;var t=e.split(/\r\n/),o="header",i=!1,a="";for(var r in null!=n.videoCodec&&""!==n.videoCodec&&(M=n.videoCodec),null!=n.audioCodec&&""!==n.audioCodec&&(y=n.audioCodec),t){var s=t[r];if(!(s.length<=0)){var c=J(s);c&&(a+=s,a+="\r\n")}}for(var l in a=F(a,G(y,"audio")),a=$(a,G(M,"video")),e=a,t=e.split(/\r\n/),a="",t){var u=t[l];if(!(u.length<=0)){if("chrome"===z.browser){var d=void 0;if(0==u.indexOf("m=audio")&&-1!==D){d=u.split(" "),a+=d[0]+" "+d[1]+" "+d[2]+" "+D+"\r\n";continue}if(0==u.indexOf("m=video")&&-1!==W){d=u.split(" "),a+=d[0]+" "+d[1]+" "+d[2]+" "+W+"\r\n";continue}}if(a+=u,0===u.indexOf("m=audio")?(o="audio",i=!1):0===u.indexOf("m=video")?(o="video",i=!1):0==u.indexOf("a=rtpmap")&&(o="bandwidth",i=!1),"chrome"===z.browser&&(0===u.indexOf("a=mid:")||0==u.indexOf("a=rtpmap"))&&!i)if(0=="audio".localeCompare(o))void 0!==n.audioBitrate&&(a+="\r\nb=CT:"+n.audioBitrate,a+="\r\nb=AS:"+n.audioBitrate),i=!0;else if(0=="video".localeCompare(o))void 0!==n.videoBitrate&&(a+="\r\nb=CT:"+n.videoBitrate,a+="\r\nb=AS:"+n.videoBitrate,void 0!==n.videoFrameRate&&(a+="\r\na=framerate:"+n.videoFrameRate)),i=!0;else if(0=="bandwidth".localeCompare(o)){var f=void 0;if(f=H(u),null!==f){var v=f[2].toLowerCase();0!="vp9".localeCompare(v)&&0!="vp8".localeCompare(v)&&0!="h264".localeCompare(v)&&0!="red".localeCompare(v)&&0!="ulpfec".localeCompare(v)&&0!="rtx".localeCompare(v)||void 0!==n.videoBitrate&&(a+="\r\na=fmtp:"+f[1]+" x-google-min-bitrate="+n.videoBitrate+";x-google-max-bitrate="+n.videoBitrate),0!="opus".localeCompare(v)&&0!="isac".localeCompare(v)&&0!="g722".localeCompare(v)&&0!="pcmu".localeCompare(v)&&0!="pcma".localeCompare(v)&&0!="cn".localeCompare(v)||void 0!==n.audioBitrate&&(a+="\r\na=fmtp:"+f[1]+" x-google-min-bitrate="+n.audioBitrate+";x-google-max-bitrate="+n.audioBitrate)}}if(("firefox"===z.browser||"safari"===z.browser)&&0==u.indexOf("c=IN")){if(0=="audio".localeCompare(o)){""!==n.audioBitrate&&(a+="\r\nb=TIAS:"+1e3*Number(n.audioBitrate)+"\r\n",a+="b=AS:"+1e3*Number(n.audioBitrate)+"\r\n",a+="b=CT:"+1e3*Number(n.audioBitrate)+"\r\n");continue}if(0=="video".localeCompare(o)){""!==n.videoBitrate&&(a+="\r\nb=TIAS:"+1e3*Number(n.videoBitrate)+"\r\n",a+="b=AS:"+1e3*Number(n.videoBitrate)+"\r\n",a+="b=CT:"+1e3*Number(n.videoBitrate)+"\r\n");continue}}a+="\r\n"}}return a}var q=void 0,K=void 0,Y=void 0,Q=void 0,X=void 0,ee=void 0,ne={videoBitrate:"",audioBitrate:"",videoFrameRate:"30",videoCodec:"42e01f",audioCodec:"opus"},te=void 0,oe=void 0,ie=void 0,ae=void 0,re={iceServers:[]};re=null;var se=void 0,ce=void 0;function le(e){console.log("WowzaPeerConnectionPublish.gotDescription: SDP:");var n=new Object;null!=ne.audioBitrate&&(n.audioBitrate=ne.audioBitrate),null!=ne.videoBitrate&&(n.videoBitrate=ne.videoBitrate),null!=ne.videoFrameRate&&(n.videoFrameRate=ne.videoFrameRate),null!=ne.videoCodec&&(n.videoCodec=ne.videoCodec),null!=ne.audioCodec&&(n.audioCodec=ne.audioCodec),null!=q&&(e.sdp=q(e.sdp,n)),console.log("WowzaPeerConnectionPublish.gotDescription: Setting local description SDP: "),ae.setLocalDescription(e).then((function(){return ie.send('{"direction":"publish", "command":"sendOffer", "streamInfo":'+JSON.stringify(ee)+', "sdp":'+JSON.stringify(e)+', "userData":'+JSON.stringify(te)+"}")})).catch((function(e){var n=Object(r["a"])({message:"Peer connection failed"},e);ge(n)}))}function ue(e){return function(){null!=ae&&ae.getStats(null).then(e,(function(e){return console.log(e)}))}}function de(e){try{ie=new WebSocket(e)}catch(n){return void ge(n)}ie.binaryType="arraybuffer",ie.onopen=function(){console.log("WowzaPeerConnectionPublish.wsConnection.onopen"),ae=new RTCPeerConnection(re),se=void 0,ce=void 0,ae.onicecandidate=function(e){null!=e.candidate&&console.log("WowzaPeerConnectionPublish.gotIceCandidate: "+{ice:e.candidate})},ae.onconnectionstatechange=function(e){null!=K&&K(e)},ae.onnegotiationneeded=function(){ae.createOffer(le,ge)};var e=X.getTracks();for(var n in e){var t=ae.addTrack(e[n],X);"audio"===e[n].type?ce=t:"video"===e[n].type&&(se=t)}},ie.onmessage=function(e){var n=JSON.parse(e.data),t=Number(n["status"]);if(200!=t)me(),ge({message:n["statusDescription"]});else{var o=n["sdp"];if(void 0!==o){var i=new Object;void 0!==ne.audioBitrate&&(i.audioBitrate=ne.audioBitrate),void 0!==ne.videoBitrate&&(i.videoBitrate=ne.videoBitrate),console.log("WowzaPeerConnectionPublish.wsConnection.onmessage: Setting remote description SDP:"),ae.setRemoteDescription(new RTCSessionDescription(o),(function(){}),ge)}var a=n["iceCandidates"];if(void 0!==a)for(var r in a)console.log("WowzaPeerConnectionPublish.wsConnection.iceCandidates: "+a[r]),ae.addIceCandidate(new RTCIceCandidate(a[r]))}},ie.onclose=function(){console.log("WowzaPeerConnectionPublish.wsConnection.onclose")},ie.onerror=function(n){console.log("wsConnection.onerror"),console.log(n);var t="Websocket connection failed: "+e;console.log(t);var o=Object(r["a"])({message:t},n);me(),ge(o)}}function fe(e,n){null!=ae&&(console.log(ae),"audio"===e?null!=ce?ce.replaceTrack(n):ce=ae.addTrack(n):"video"===e&&(null!=se?se.replaceTrack(n):se=ae.addTrack(n)))}function ve(e){var n=e.wsURL;X=e.localStream,null!=e.streamInfo&&(ee=e.streamInfo),null!=e.mediaInfo&&(ne=e.mediaInfo),null!=e.userData&&(te=e.userData),null!=e.mungeSDP&&(q=e.mungeSDP),null!=e.onconnectionstatechange&&(K=e.onconnectionstatechange),null!=e.onstop&&(Y=e.onstop),null!=e.onerror&&(Q=e.onerror),null!=e.onstats&&(oe=setInterval(ue(e.onstats),5e3)),null==ae?(null!=ie&&ie.close(),ie=null,console.log("WowzaPeerConnectionPublish.start: wsURL:"+n+" streamInfo:"+JSON.stringify(ee)),de(n)):console.log("WowzaPeerConnectionPublish.start: peerConnection already in use, not starting")}function me(){null!=ae&&ae.close(),ae=void 0,se=void 0,ce=void 0,null!=ie&&ie.close(),ie=void 0,null!=oe&&(clearInterval(oe),oe=void 0),null!=Y&&Y()}function pe(){return null!=ae}function ge(e){console.trace(),null!=Q&&Q(e)}var he={connect:de,start:ve,stop:me,isStarted:pe,replaceTrack:fe};function be(e){this.context=e,this.instant=0,this.slow=0,this.clip=0,this.script=e.createScriptProcessor(2048,1,1);var n=this;this.script.onaudioprocess=function(e){var t,o=e.inputBuffer.getChannelData(0),i=0,a=0;for(t=0;t<o.length;++t)i+=o[t]*o[t],Math.abs(o[t])>.99&&(a+=1);n.instant=Math.sqrt(i/o.length),n.slow=.95*n.slow+.05*n.instant,n.clip=a/o.length}}be.prototype.connectToSource=function(e,n){try{this.mic=this.context.createMediaStreamSource(e),this.mic.connect(this.script),this.script.connect(this.context.destination),"undefined"!==typeof n&&n(null)}catch(t){console.error(t),"undefined"!==typeof n&&n(t)}},be.prototype.stop=function(){this.mic.disconnect(),this.script.disconnect()};var Ee=be;window.AudioContext=window.AudioContext||window.webkitAudioContext||!1;var _e={ready:!1,connectionState:"stopped",videoElementPublish:void 0,stream:void 0,isScreenSharing:!1,constraints:{video:{width:{min:"640",ideal:"1280",max:"1920"},height:{min:"360",ideal:"720",max:"1080"},frameRate:"30"},audio:!0},sdpURL:"",streamInfo:{applicationName:"",streamName:"",sessionId:"[empty]"},mediaInfo:{videoBitrate:"",audioBitrate:"",videoFrameRate:"30",videoCodec:"VP8",audioCodec:"opus"},userData:{param1:"value1"},audioEnabled:!0,videoEnabled:!0,useSoundMeter:!1,cameras:[],microphones:[]},Se=void 0,Te=void 0,Ce={},Re=function(e){return new Promise((function(n){_e=Object(r["a"])(Object(r["a"])({},_e),e),null!=Ce.onStateChanged&&Ce.onStateChanged(_e),n(_e)}))},we=function(){return _e},Be=function(e){Ce=e},Pe=function(){var e=Object(L["a"])(regeneratorRuntime.mark((function e(n){var t,o,i,a,s,c,l;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log("WowzaWebRTC.set"),console.log(n),t=we(),o=Object(r["a"])({},t.streamInfo),i=Object(r["a"])({},t.mediaInfo),a={},s=!1,null!=n.videoElementPublish&&(a["videoElementPublish"]=n.videoElementPublish),null!=n.useSoundMeter&&(a["useSoundMeter"]=n.useSoundMeter),null!=n.sdpURL&&(a["sdpURL"]=n.sdpURL.trim()),null!=n.applicationName&&(o["applicationName"]=n.applicationName.trim()),null!=n.streamName&&(o["streamName"]=n.streamName.trim()),null!=n.sessionId&&(o["sessionId"]=n.sessionId),null!=n.streamInfo&&(o=Object(r["a"])(Object(r["a"])({},o),n.streamInfo)),a["streamInfo"]=o,null!=n.videoBitrate&&(i.videoBitrate=n.videoBitrate),null!=n.audioBitrate&&(i.audioBitrate=n.audioBitrate),null!=n.videoFrameRate&&(i.videoFrameRate=n.videoFrameRate,a["constraints"]=Object(r["a"])({},t.constraints),"boolean"!==typeof a["constraints"]["video"]&&(""===i.videoFrameRate?delete a["constraints"]["video"]["frameRate"]:a["constraints"]["video"]["frameRate"]=n.videoFrameRate)),null!=n.videoCodec&&(i.videoCodec=n.videoCodec),null!=n.audioCodec&&(i.audioCodec=n.audioCodec),null!=n.mediaInfo&&(i=Object(r["a"])(Object(r["a"])({},i),n.streamInfo)),a["mediaInfo"]=i,null!=n.userData&&(a["userData"]=Object(r["a"])({},n.userData)),null!=n.constraints&&(a["constraints"]=n.constraints),null!=a.constraints&&JSON.stringify(t.constraints)!==JSON.stringify(a.constraints)&&(s=!0),e.prev=25,e.next=28,Re(a);case 28:if(c=e.sent,null!=c.stream){e.next=32;break}return e.next=32,Ie();case 32:return e.next=34,Ae();case 34:if(l=e.sent,!s||null==l.stream){e.next=38;break}return e.next=38,Oe(l.stream,l.constraints);case 38:return e.abrupt("return",we());case 41:return e.prev=41,e.t0=e["catch"](25),Ve(e.t0),e.abrupt("return",null);case 45:case"end":return e.stop()}}),e,null,[[25,41]])})));return function(n){return e.apply(this,arguments)}}(),Oe=function(e,n){var t=[],o=e.getAudioTracks(),i=e.getVideoTracks();for(var a in o)t.push(o[a].applyConstraints(n["audio"]));for(var r in i)t.push(i[r].applyConstraints(n["video"]));return Promise.all(t)},Ie=function(e){return e=e||"both",new Promise((function(n,t){console.log("WowzaWebRTCPublish.getUserMedia");var o=we(),i=[],a=[];function r(e){return s.apply(this,arguments)}function s(){return s=Object(L["a"])(regeneratorRuntime.mark((function t(r){var s,c,l,u,d,f,v,m;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if("audio"===e&&a.length>0){for(c in s=r.getVideoTracks(),s)r.removeTrack(s[c]);r.addTrack(a[0])}else if("video"===e&&i.length>0){for(u in l=r.getAudioTracks(),l)r.removeTrack(l[u]);r.addTrack(i[0])}if(d={stream:r},"audio"!==e&&o.isScreenSharing){for(f in a)a[f].stop();d["isScreenSharing"]=!1}try{o.videoElementPublish.srcObject=r,d["ready"]=!0}catch(p){console.log("getUserMediaSuccess: error connecting stream to videoElementPublish, trying createObjectURL"),console.log(p),o.videoElementPublish.src=window.URL.createObjectURL(r),d["ready"]=!0}try{"video"!==e&&window.AudioContext&&o.useSoundMeter&&(v=new AudioContext,m=new Ee(v),m.connectToSource(r,(function(e){e?console.log(e):Te=setInterval((function(){var e=we().audioEnabled?m.instant.toFixed(2):0;null!=Ce.onSoundMeter&&Ce.onSoundMeter(e)}),200)})))}catch(g){console.log("getUserMediaSuccess: error creating audio meter"),console.log(g)}return t.next=7,Re(d);case 7:n(d);case 8:case"end":return t.stop()}}),t)}))),s.apply(this,arguments)}null!=o.stream&&(i=o.stream.getAudioTracks(),a=o.stream.getVideoTracks()),"video"!==e&&(null!=Se&&Se.stop(),null!=Te&&clearInterval(Te)),null==o.videoElementPublish&&t({message:"videoElementPublish not set"}),navigator.mediaDevices.getUserMedia?navigator.mediaDevices.getUserMedia(o.constraints).then(r).catch(Ve):navigator.getUserMedia?navigator.getUserMedia(o.constraints,r,(function(e){Ve(e),t(e)})):(Ve({message:"Your browser does not support WebRTC"}),t())}))},Ae=function(){return new Promise((function(e,n){console.log("WowzaWebRTCPublish.getDevices"),navigator.mediaDevices.enumerateDevices().then((function(n){for(var t=Object(r["a"])({},we().constraints),o=[],i=[],a=0;a<n.length;a++)"videoinput"===n[a].kind?(0===o.length&&(t.video=Object.assign({},t.video,{deviceId:n[a].deviceId})),o.push(n[a])):"audioinput"===n[a].kind&&(0===i.length&&(t.audio=Object.assign({},t.audio,{deviceId:n[a].deviceId})),i.push(n[a]));var s={cameras:o,microphones:i,constraints:t};e(Re(s))})).catch((function(e){console.log("unable to detect AV devices: "+e),n(e)}))}))};function Me(e){null!=e.target&&null!=e.target.connectionState&&Re({connectionState:e.target.connectionState})}function ye(){Re({connectionState:"stopped"})}function We(e,n){var t=we();null!=t.stream&&null!=t.stream.getTracks&&t.stream.getTracks().map((function(t){t.kind===e&&(t.enabled=n)}))}function De(e){console.log("WowzaWebRTC.setAudioEnabled:"+e),We("audio",e),Re({audioEnabled:e})}function xe(e){console.log("WowzaWebRTC.setVideoEnabled:"+e),We("video",e),Re({videoEnabled:e})}function ke(){return new Promise((function(e,n){var t=we().stream;function o(o){var i={stream:o,isScreenSharing:!0};t.getAudioTracks().length>0&&o.addTrack(t.getAudioTracks()[0]);try{we().videoElementPublish.srcObject=o,i["ready"]=!0}catch(a){n(a)}Re(i),e(o)}var i={video:!0};navigator.getDisplayMedia?navigator.getDisplayMedia(i).then((function(e){o(e,i)})).catch((function(e){n(e)})):navigator.mediaDevices.getDisplayMedia?navigator.mediaDevices.getDisplayMedia(i).then((function(e){o(e,i)})).catch((function(e){n(e)})):(i={video:{mediaSource:"screen"}},navigator.mediaDevices.getUserMedia(i).then((function(e){o(e,i)})).catch((function(e){n(e)})))}))}var Ne=function e(n){if(console.log("WowzaWebRTC.setCamera: "+n),"screen"===n)ke().then((function(n){var t=we();We("audio",t.audioEnabled),We("video",t.videoEnabled),n.getVideoTracks()[0].onended=function(){var n=we();n.cameras.length>0&&e(n.cameras[0].deviceId)},he.isStarted()&&(Le(),Ue()),null!=Ce.onCameraChanged&&Ce.onCameraChanged("screen")}));else{var t=Object(r["a"])({},_e.constraints);"boolean"===typeof t.video&&(t.video={}),t.video=Object.assign({},t.video,{deviceId:n}),Re({constraints:t}).then((function(){Ie("video").then((function(){var e=we();We("audio",e.audioEnabled),We("video",e.videoEnabled),he.isStarted()&&(Le(),Ue()),null!=Ce.onCameraChanged&&Ce.onCameraChanged(n)}))}))}},je=function(e){console.log("WowzaWebRTC.setMicrophone: "+e);var n=Object(r["a"])({},_e.constraints);"boolean"===typeof n.audio&&(n.audio={}),n.audio=Object.assign({},n.audio,{deviceId:e}),Re({constraints:n}).then((function(){Ie("audio").then((function(){var n=we();We("audio",n.audioEnabled),We("video",n.videoEnabled),he.isStarted()&&(Le(),Ue()),null!=Ce.onMicrophoneChanged&&Ce.onMicrophoneChanged(e)}))}))},Ue=function(){var e=we();console.log("WowzaWebRTC.start()"),he.start({wsURL:e.sdpURL,localStream:e.stream,streamInfo:e.streamInfo,mediaInfo:e.mediaInfo,userData:e.userData,mungeSDP:Z,onconnectionstatechange:Me,onstop:ye,onstats:Ce.onStats||void 0,onerror:Ve})},Le=function(){console.log("WowzaWebRTC.stop()"),he.stop()},Ve=function(e){console.log("WowzaWebRTC ERROR:"),console.log(e),null==e.message&&null!=e.target&&console.log("typeof error.target: "+Object(U["a"])(e.target)),null!=Ce.onError&&Ce.onError(e)},ze={on:Be,set:Pe,getState:we,start:Ue,stop:Le,setAudioEnabled:De,setVideoEnabled:xe,setCamera:Ne,setMicrophone:je},Fe=ze,$e=(t("ade3"),{}),Ge="STR_USER_NAME",Je="STR_WEB_RTC_URL",He="STR_WEB_RTC_RECEIVE_STREAM",Ze="STR_WEB_RTC_SENDER_STREAM",qe="STR_WEB_RTC_VIDEO_BITRATE",Ke="STR_WEB_RTC_AUDIO_BITRATE",Ye="STR_WEB_RTC_FRAME_SIZE",Qe="STR_WEB_RTC_FRMAE_RATE",Xe={STR_USER_NAME:Ge,STR_WEB_RTC_URL:Je,STR_WEB_RTC_RECEIVE_STREAM:He,STR_WEB_RTC_SENDER_STREAM:Ze,STR_WEB_RTC_VIDEO_BITRATE:qe,STR_WEB_RTC_AUDIO_BITRATE:Ke,STR_WEB_RTC_FRAME_SIZE:Ye,STR_WEB_RTC_FRMAE_RATE:Qe},en={STR_USER_NAME:"",STR_WEB_RTC_URL:"5f852799e11d1",STR_WEB_RTC_RECEIVE_STREAM:"",STR_WEB_RTC_SENDER_STREAM:"Test",STR_WEB_RTC_VIDEO_BITRATE:2e3,STR_WEB_RTC_AUDIO_BITRATE:64,STR_WEB_RTC_FRAME_SIZE:"default",STR_WEB_RTC_FRMAE_RATE:30};function nn(e){var n=$e;return n&&n[e]?n[e]:en[e]}var tn="EVENT_SET_EVENT_TYPE",on="EVENT_PUBLISH_WEBRTC",an="EVENT_SHOW_SNACKBAR",rn="EVENT_SET_VIDEO_LIST",sn="EVENT_SET_AUDIO_LIST",cn="EVENT_SET_CAMERA_ID",ln=new o["a"];window.WowzaWebRTCPublish=Fe;var un=V["a"].browserDetails;function dn(){return{sdpURL:"wss://".concat(nn(Xe.STR_WEB_RTC_URL),".streamlock.net/webrtc-session.json"),applicationName:"live",streamName:nn(Xe.STR_WEB_RTC_SENDER_STREAM),audioBitrate:nn(Xe.STR_WEB_RTC_AUDIO_BITRATE),audioCodec:"opus",videoBitrate:nn(Xe.STR_WEB_RTC_VIDEO_BITRATE),videoCodec:"VP8",videoFrameRate:nn(Xe.STR_WEB_RTC_FRMAE_RATE),frameSize:nn(Xe.STR_WEB_RTC_FRAME_SIZE)}}var fn=null,vn=null,mn={publishing:!1,pendingPublish:!1,pendingPublishTimeout:void 0,muted:!1,video:!0,selectedCam:"",selectedMic:"",settings:dn()},pn=function(e,n,t,o,i){Mn(),Fe.on({onStateChanged:function(o){console.log("WowzaWebRTCPublish.onStateChanged"),"connected"===o.connectionState?e():"failed"===o.connectionState?n():t()},onCameraChanged:function(e){e!==mn.selectedCam&&(mn.selectedCam=e)},onMicrophoneChanged:function(e){e!==mn.selectedMic&&(mn.selectedMic=e)},onError:o,onSoundMeter:i}),Fe.set({videoElementPublish:document.getElementById("wowza-sender"),useSoundMeter:!1}).then((function(e){ln.$emit(rn,e.cameras),ln.$emit(sn,e.microphones);var n=e.cameras[0].deviceId.replace("CameraMobile_","");Fe.setCamera(n),mn.selectedCam=n}))},gn=function(){if(""===mn.settings.sdpURL)throw"No stream configured.";if(""===mn.settings.applicationName)throw"Missing application name.";if(""===mn.settings.streamName)throw"Missing stream name.";return!0},hn=function(e){var n=JSON.parse(JSON.stringify(Fe.getState().constraints));if("default"===e)n.video["width"]={min:"640",ideal:"1280",max:"1920"},n.video["height"]={min:"360",ideal:"720",max:"1080"};else{var t=e.split("x");n.video["width"]={exact:t[0]},n.video["height"]={exact:t[1]}}Fe.set({constraints:n})},bn=function(e){return mn.settings=e,Fe.set(e)},En=function(){gn()&&Fe.start()},_n=function(){Fe.stop()},Sn=function(){Fe.setVideoEnabled(!0)},Tn=function(){Fe.setAudioEnabled(!1)},Cn=function(e){var n;"OverconstrainedError"==e.name?(console.log("OverconstrainedError"),hn("default")):n=e.message?e.message:e,Bn(n),_n()},Rn=function e(n){n?(console.log("Publish Disable"),mn.pendingPublish=!0,mn.pendingPublishTimeout=setTimeout((function(){_n(),Cn({message:"Publish failed. Unable to connect."}),e(!1)}),1e4)):(mn.pendingPublish=!1,null!=mn.pendingPublishTimeout&&(clearTimeout(mn.pendingPublishTimeout),mn.pendingPublishTimeout=void 0))},wn=function(){return bn(mn.settings)},Bn=function(e){console.log("showErrorPanel",e),fn(e)},Pn=function(){console.log("hideErrorPanel"),vn()},On=function(){mn.publishing=!0,Rn(!1),Pn(),console.log("onPublishPeerConnected")},In=function(){Rn(!1),On(),Cn({message:"Peer connection failed."}),console.log("onPublishPeerConnectionFailed")},An=function(){mn.pendingPublish||(mn.publishing=!1,console.log("onPublishPeerConnectionStopped"))},Mn=function(){Sn(),Tn(),ln.$on(cn,(function(e){Fe.setCamera(e),mn.selectedCam=e}))},yn=function(e,n){fn=e,vn=n;var t=function(){var e=mn.settings;null!=e.frameSize&&""!==e.frameSize&&"default"!==e.frameSize&&hn(e.frameSize),"safari"===un.browser&&console.log("Safari don't support VP9")};t(),pn(On,In,An,Cn)};function Wn(){_n();try{Sn(),Pn(),console.log("PPPPPublish"),mn.settings=dn(),console.log(mn.settings.videoBitrate),wn().then((function(){Rn(!0),En()}))}catch(e){Cn(e)}}var Dn={created:function(){var e=function(e){ln.$emit(an,e)},n=function(){console.log("### onHide")};this.$nextTick((function(){console.log("Sender Created"),yn(e,n)})),ln.$on(on,(function(){console.log("RECEIVE PUBLISH")}))}},xn=Dn,kn=Object(p["a"])(xn,N,j,!1,null,"3cc362ee",null),Nn=kn.exports,jn={data:function(){return{sender_bg_class:"preset_bg_sender",sender_class:"preset_sender",test_message:""}},components:{WebRTCSender:Nn},created:function(){var e=this;ln.$on(tn,(function(n){e.test_message=n,e.sender_class="live_sender"}))},methods:{goBack:function(){this.$router.go(-1)},gotoHome:function(){this.$router.push("/info")}}},Un=jn,Ln=(t("d7ac"),Object(p["a"])(Un,x,k,!1,null,"21dc230c",null)),Vn=Ln.exports,zn=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",{staticClass:"root"},[e._v(" Preset "),t("button",{on:{click:e.gotoLive}},[e._v("To Live")])])},Fn=[],$n={methods:{gotoLive:function(){console.log("PUBLISH"),Wn(),this.$router.push("/event/live")},beforeEnter:function(e,n,t){console.log("TO",e),console.log("from",n,t)}}},Gn=$n,Jn=(t("03f0"),Object(p["a"])(Gn,zn,Fn,!1,null,"eaa6a8a6",null)),Hn=Jn.exports,Zn=function(){var e=this,n=e.$createElement,t=e._self._c||n;return t("div",[e._v(" LIVE ")])},qn=[],Kn={},Yn=Kn,Qn=Object(p["a"])(Yn,Zn,qn,!1,null,null,null),Xn=Qn.exports;o["a"].use(E["a"]);var et=[{path:"/",redirect:"/info"},{path:"/info",component:I},{path:"/event",component:Vn,children:[{path:"preset",component:Hn},{path:"live",component:Xn}]}],nt=new E["a"]({routes:et}),tt=nt,ot=(t("99af"),t("4160"),t("159b"),t("2f62"));o["a"].use(ot["a"]);var it,at=100,rt=new ot["a"].Store({state:{dic_list:[],last_timestamp:0,messages:[],user_name:"",emoji_list:["😍","🥳","✌🏻","😺","🤡","👍🏻","💋","⭐️","🌹"]},getters:{getMessages:function(e){return e.messages},getHlsUrl:function(e){return e.hrl_url}},mutations:{ADD_MESSAGES:function(e,n){e.messages.length>=at&&e.messages.shift(),e.messages=e.messages.concat(n)},SET_NAME:function(e,n){e.user_name=n},DELETE_MESSAGE_EVENT:function(){clearTimeout(it),it=null}},actions:{LOAD_MESSAGES:function(e){var n=e.state,t=e.commit;return u(at).then((function(e){var o=[];return e.forEach((function(e){n.dic_list.push(e.key);var t=e.val();n.last_timestamp=t.time;var i=t.type||"MESSAGE";if("MESSAGE"===i){a&&(t.isMine=!0),t.index=e.key;var a=t.user===n.user_name;o.push(t)}})),t("ADD_MESSAGES",o),e}))},SET_MESSAGE_EVENT:function(e){var n=e.state,t=e.commit;it=setInterval(Object(L["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:d(n.last_timestamp).then((function(e){var o=null,i=[];e.forEach((function(e){var t=e.val();o=t;var a=-1!=n.dic_list.indexOf(e.key);if(!a){var r=t.type||"MESSAGE";if("MESSAGE"===r){t.index=e.key;var s=t.user===n.user_name;s||i.push(e.val())}else ln.$emit("RECIEVE_DATA",e.val());n.dic_list.push(e.key)}})),i.length>0&&(t("ADD_MESSAGES",i),1==o&&(n.last_timestamp=o.time))}));case 1:case"end":return e.stop()}}),e)}))),1e3)},SEND_MESSAGE:function(e,n){var t=e.commit,o=e.state,i={type:"MESSAGE",user:o.user_name,time:(new Date).getTime(),message:n};f("messages",i).then((function(e){return console.log("SEND_RESULT",e),e||t("ADD_MESSAGES",Object(r["a"])(Object(r["a"])({},i),{},{isMine:!0})),e}))},ADD_EMOJI:function(e,n){var t=e.state,o={type:"EMOJI",user:t.user_name,time:(new Date).getTime(),message:n};f("messages",o).then((function(e){return console.log("SEND_EMOJI_RESULT",e),e}))}},modules:{}}),st=t("f309");o["a"].use(st["a"]);var ct=new st["a"]({});o["a"].config.productionTip=!1,new o["a"]({router:tt,store:rt,vuetify:ct,render:function(e){return e(h)}}).$mount("#app")},"73c5":function(e,n,t){},d7ac:function(e,n,t){"use strict";t("73c5")}});
//# sourceMappingURL=app.e70b1350.js.map